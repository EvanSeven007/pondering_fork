/*
  Fiddler, a UCI-compatible chess engine.
  Copyright (C) 2022 The Fiddler Authors (see AUTHORS.md file)

  Fiddler is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  Fiddler is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

//! Hash key generation for boards.

use crate::{Color, Piece, Square};

#[inline(always)]
/// Get the Zobrist key for a given key, type, and square.
pub fn square_key(sq: Square, pt: Option<Piece>, color: Color) -> u64 {
    match pt {
        None => 0,
        // Because sq, p, and color are all enums with fixed ranges, we can
        // perform an unchecekd get on these indices.
        Some(p) => unsafe {
            *SQUARE_KEYS
                .get_unchecked(sq as usize)
                .get_unchecked(p as usize)
                .get_unchecked(color as usize)
        },
    }
}

#[inline(always)]
/// Get the Zobrist key for a castling right. 0 is for white king castle, 1 is
/// for white queen castle, 2 is for black king castle, and 3 is for black
/// queen castle.
pub const fn get_castle_key(right: u8) -> u64 {
    CASTLE_KEYS[right as usize]
}

#[inline(always)]
/// Get the Zobrist key of an en passant square.
pub fn ep_key(ep_square: Option<Square>) -> u64 {
    match ep_square {
        None => 0,
        // Since the square is in the square enum, we can safely get this
        // without checking.
        Some(sq) => unsafe { *EP_KEYS.get_unchecked(sq.file() as usize) },
    }
}

#[inline(always)]
/// Get the Zobrist key for the player to move
pub const fn player_key(player_to_move: Color) -> u64 {
    match player_to_move {
        Color::White => 0,
        Color::Black => BLACK_TO_MOVE_KEY,
    }
}

/// A set of random keys which will reliably be the same.
/// If one wanted, they could generate a new set of keys on every program run,
/// but that seems inefficient.
const SQUARE_KEYS: [[[u64; 2]; Piece::NUM]; 64] = [
    [
        [13_515_657_874_892_102_023, 15_129_553_140_981_592_645],
        [14_809_938_836_708_178_893, 15_774_518_201_988_393_282],
        [17_188_393_767_951_940_199, 4_985_137_385_606_203_988],
        [8_046_993_897_209_325_893, 6_881_813_287_187_799_947],
        [16_125_670_290_659_210_324, 4_816_260_449_376_201_035],
        [11_570_069_662_165_393_444, 11_285_152_104_292_927_369],
    ],
    [
        [3_446_018_582_270_436_793, 13_616_437_186_283_622_689],
        [13_519_059_396_826_741_711, 9_796_009_710_311_115_986],
        [13_565_560_346_403_939_986, 10_792_308_714_086_901_791],
        [3_072_727_624_150_280_346, 3_794_756_855_380_371_525],
        [1_435_931_999_638_272_781, 15_441_221_205_979_428_565],
        [5_940_567_713_233_535_239, 8_464_077_112_431_967_362],
    ],
    [
        [495_664_619_263_271_681, 9_420_932_444_907_695_650],
        [12_741_368_234_109_995_270, 7_664_225_158_426_101_066],
        [123_100_759_219_922_640, 12_246_793_704_608_856_168],
        [3_021_706_240_337_810_846, 10_701_126_688_782_509_631],
        [5_286_375_280_603_737_045, 12_037_244_071_987_171_008],
        [1_953_382_953_708_866_778, 12_569_849_586_622_039_179],
    ],
    [
        [3_350_919_833_121_026_612, 6_917_572_908_190_574_316],
        [17_712_016_599_341_141_622, 10_994_228_475_909_012_897],
        [16_844_352_835_873_823_081, 6_085_447_665_261_760_849],
        [742_500_085_444_621_992, 2_209_962_125_935_807_334],
        [9_209_073_793_829_003_437, 13_598_795_564_570_686_766],
        [13_946_642_687_760_876_726, 12_353_966_073_431_331_312],
    ],
    [
        [4_754_343_899_128_033_937, 7_999_896_076_212_440_554],
        [16_897_746_622_936_208_918, 2_395_661_151_836_497_898],
        [18_073_709_211_994_443_880, 5_558_496_187_847_604_090],
        [15_948_151_388_970_225_971, 172_597_821_324_353_835],
        [17_801_296_389_112_086_916, 6_451_330_536_465_442_251],
        [6_308_175_451_005_450_063, 7_120_683_906_288_837_975],
    ],
    [
        [236_895_846_088_702_896, 1_123_221_273_390_886_733],
        [8_210_899_693_915_372_461, 7_159_189_460_286_746_686],
        [14_740_380_003_831_013_958, 3_310_910_749_645_895_425],
        [215_996_133_496_893_554, 13_140_254_967_128_155_258],
        [3_972_520_063_736_808_413, 9_454_387_687_692_677_134],
        [2_241_369_823_883_942_596, 11_471_090_748_910_479_112],
    ],
    [
        [254_892_419_357_612_817, 9_071_938_695_347_067_170],
        [14_240_662_866_761_158_599, 17_820_701_860_784_163_862],
        [17_019_042_975_767_554_549, 10_142_200_304_454_143_677],
        [6_719_910_664_025_650_302, 12_227_359_393_470_203_212],
        [2_202_202_444_884_407_082, 2_760_730_179_108_792_751],
        [9_129_165_348_354_779_568, 16_463_810_222_779_680_359],
    ],
    [
        [6_189_910_006_475_770_528, 3_749_341_880_136_721_304],
        [3_002_308_468_479_489_223, 2_769_677_883_324_350_151],
        [1_671_196_606_386_453_292, 12_833_774_114_208_833_848],
        [2_703_214_826_562_935_424, 12_132_134_214_268_140_228],
        [16_342_691_665_418_270_362, 15_407_886_221_016_473_523],
        [17_225_736_924_774_608_060, 15_691_010_154_271_609_526],
    ],
    [
        [4_875_081_210_458_220_180, 13_835_488_679_462_871_749],
        [1_219_633_687_171_738_399, 13_861_914_381_804_840_313],
        [8_501_463_582_677_749_277, 3_356_156_007_447_137_140],
        [16_951_352_228_835_675_164, 3_400_123_950_416_765_309],
        [6_879_041_868_768_447_104, 3_245_900_172_204_009_703],
        [3_280_796_154_694_990_799, 10_544_962_268_059_163_078],
    ],
    [
        [15_190_462_450_199_705_153, 16_479_028_770_895_632_643],
        [17_712_200_011_694_641_618, 9_466_971_872_010_357_883],
        [7_702_114_492_101_903_268, 2_216_293_578_142_963_653],
        [11_874_895_798_415_470_047, 13_716_350_736_066_119_448],
        [11_587_208_491_360_567_030, 10_537_423_829_264_651_920],
        [13_819_369_558_524_233_243, 9_794_525_146_463_145_015],
    ],
    [
        [4_302_523_723_566_195_431, 10_475_242_094_662_107_668],
        [2_312_500_128_173_556_785, 9_413_901_950_967_830_200],
        [14_229_509_250_589_227_890, 16_444_977_514_914_674_576],
        [1_092_094_222_684_883_897, 14_336_988_344_293_731_611],
        [812_394_947_067_494_019, 14_743_184_481_622_720_604],
        [9_885_644_567_209_155_075, 1_984_249_643_104_776_717],
    ],
    [
        [13_997_893_337_761_777_888, 2_880_890_189_287_616_219],
        [16_239_442_326_123_452_825, 11_710_128_666_576_187_848],
        [5_071_563_865_067_304_343, 8_191_986_895_770_187_453],
        [6_801_043_646_299_192_381, 5_667_842_744_804_691_012],
        [11_259_406_877_500_171_085, 5_752_592_898_619_856_201],
        [9_085_165_825_001_424_155, 929_057_713_734_539_710],
    ],
    [
        [8_219_098_178_975_139_502, 4_051_554_117_729_101_870],
        [2_510_049_438_397_274_779, 37_539_989_512_659_499],
        [17_885_833_627_067_471_158, 14_841_920_734_294_932_415],
        [1_533_724_647_794_856_334, 2_048_711_013_915_015_826],
        [16_088_201_148_346_570_085, 15_918_573_569_284_344_452],
        [9_048_644_028_699_911_106, 5_029_010_618_217_972_638],
    ],
    [
        [3_847_131_426_912_768_470, 5_536_765_039_475_735_656],
        [5_816_357_415_300_583_143, 7_162_469_989_669_573_156],
        [11_378_905_987_195_004_573, 6_795_882_747_517_997_663],
        [15_956_024_853_442_510_940, 7_733_943_280_753_902_464],
        [2_961_185_793_115_268_907, 2_635_017_936_014_971_198],
        [5_654_153_221_234_187_655, 6_139_674_184_629_124_032],
    ],
    [
        [3_706_048_374_401_557_226, 2_765_206_443_233_383_179],
        [17_555_890_547_596_017_841, 581_555_062_465_446_482],
        [18_394_352_343_749_710_840, 7_233_658_005_278_787_601],
        [15_983_800_366_294_684_311, 4_452_266_131_179_350_573],
        [8_939_982_845_187_747_816, 10_669_419_923_270_603_356],
        [4_780_555_328_709_021_645, 9_820_253_591_571_635_384],
    ],
    [
        [2_921_705_737_197_482_145, 13_673_504_011_398_697_627],
        [701_214_022_870_724_154, 16_075_435_385_646_555_774],
        [1_733_730_555_209_352_268, 3_824_522_835_797_285_545],
        [9_300_857_857_734_498_685, 17_733_362_906_453_806_440],
        [18_091_059_300_905_431_170, 280_646_307_971_082_086],
        [9_592_133_770_406_705_170, 10_854_810_339_779_764_535],
    ],
    [
        [6_001_800_049_176_622_608, 14_065_975_969_455_046_841],
        [16_602_061_026_503_773_396, 8_438_916_352_800_520_713],
        [8_109_449_197_853_496_498, 6_857_602_186_584_140_873],
        [504_565_317_601_412_469, 7_165_342_442_415_664_776],
        [12_435_925_833_963_587_604, 9_978_008_497_326_312_433],
        [10_962_506_466_513_424_050, 5_888_892_666_789_012_334],
    ],
    [
        [8_073_093_768_810_702_277, 5_884_743_457_921_404_278],
        [7_184_599_454_185_378_354, 5_505_776_892_952_096_457],
        [7_004_556_387_130_681_357, 11_483_647_489_890_586_274],
        [10_519_422_850_103_058_427, 8_968_319_072_355_583_688],
        [2_189_576_784_016_640_528, 11_340_773_966_255_892_325],
        [613_541_993_151_380_931, 944_746_977_838_023_604],
    ],
    [
        [15_403_046_205_723_302_446, 9_685_912_476_233_493_576],
        [8_493_731_688_670_646_629, 8_653_313_068_594_333_475],
        [7_809_539_545_670_843_967, 16_657_864_039_519_841_112],
        [6_078_611_127_004_872_991, 14_472_837_809_762_854_105],
        [7_068_805_004_932_505_562, 10_021_674_466_772_267_409],
        [18_433_059_359_754_779_580, 12_655_079_871_591_682_036],
    ],
    [
        [8_698_923_853_861_779_317, 3_328_150_744_091_176_177],
        [3_845_570_127_062_622_223, 10_595_356_001_425_089_451],
        [10_167_046_230_606_908_870, 3_945_370_502_885_661_952],
        [12_410_271_439_419_987_436, 8_401_590_340_661_490_346],
        [14_001_652_878_199_674_597, 12_001_600_185_277_028_406],
        [1_350_534_806_158_850_049, 16_596_650_780_766_233_983],
    ],
    [
        [1_286_641_337_526_839_560, 14_902_014_645_110_978_261],
        [1_742_545_447_434_564_826, 10_456_504_947_366_666_880],
        [3_940_049_762_519_602_869, 5_121_248_166_771_395_387],
        [9_180_397_479_822_025_170, 13_543_430_662_236_689_210],
        [8_240_775_069_717_263_661, 7_444_115_909_587_059_783],
        [4_595_697_880_528_574_621, 8_312_132_785_784_667_826],
    ],
    [
        [15_441_654_137_287_150_866, 9_305_172_862_618_369_250],
        [9_557_846_983_478_291_839, 9_460_913_230_583_332_088],
        [9_964_955_357_692_366_853, 12_560_140_615_587_145_336],
        [4_405_694_664_027_662_415, 9_098_226_866_343_546_155],
        [1_520_347_936_722_403_613, 8_588_021_447_873_005_033],
        [6_046_045_842_675_880_505, 8_194_311_226_856_896_478],
    ],
    [
        [7_833_101_518_264_898_751, 2_298_587_622_176_603_340],
        [4_020_732_659_928_169_577, 11_379_043_003_751_970_156],
        [16_983_251_254_711_162_722, 4_837_154_683_380_640_805],
        [16_248_092_391_112_713_753, 14_339_567_456_591_350_213],
        [3_246_696_302_234_862_481, 103_286_982_553_998_369],
        [13_506_180_587_600_915_473, 5_096_508_690_172_926_085],
    ],
    [
        [14_874_368_531_026_464_522, 8_841_811_441_281_811_968],
        [6_129_842_650_868_402_849, 11_643_452_713_741_453_620],
        [14_579_780_478_759_161_546, 5_574_861_350_962_174_201],
        [13_413_056_971_447_411_005, 6_770_407_480_130_249_139],
        [17_269_501_669_174_047_737, 18_188_846_021_733_073_843],
        [4_250_985_302_956_179_630, 16_971_576_073_837_852_559],
    ],
    [
        [3_763_658_382_942_842_373, 16_939_301_748_933_350_815],
        [107_905_296_164_793_381, 2_791_638_973_359_621_664],
        [10_736_653_257_205_027_830, 17_132_756_303_845_540_535],
        [2_459_090_258_910_070_954, 3_932_657_329_632_269_004],
        [15_451_026_766_375_622_090, 11_492_066_180_030_965_451],
        [9_411_561_845_631_174_232, 534_866_473_465_365_570],
    ],
    [
        [7_908_754_111_196_696_099, 16_999_508_699_883_027_622],
        [10_718_385_396_005_537_231, 14_590_866_674_972_069_064],
        [11_813_628_010_819_326_433, 12_184_185_840_868_700_487],
        [8_119_493_788_028_810_486, 10_375_735_932_604_079_359],
        [5_164_723_878_777_677_434, 5_210_646_178_110_629_002],
        [1_349_105_120_390_208_534, 8_804_530_187_640_763_946],
    ],
    [
        [15_673_105_961_070_325_757, 8_901_426_037_300_317_133],
        [11_970_601_808_154_697_059, 16_589_808_676_133_281_381],
        [876_317_825_781_207_391, 1_813_831_521_813_494_383],
        [16_601_368_196_528_947_961, 2_199_485_887_224_225_382],
        [12_239_081_181_696_491_555, 16_379_232_572_083_880_035],
        [13_502_142_480_378_247_063, 8_795_531_688_847_485_970],
    ],
    [
        [18_102_865_503_213_786_336, 12_698_472_168_401_885_601],
        [2_235_216_999_254_036_599, 7_948_703_970_817_338_580],
        [18_267_287_593_607_045_447, 134_573_010_360_514_964],
        [8_464_256_675_254_656_746, 11_565_019_891_275_682_502],
        [6_566_172_802_782_242_580, 15_524_123_158_519_870_048],
        [4_978_072_196_553_269_461, 2_664_517_733_480_094_252],
    ],
    [
        [2_958_856_770_638_028_723, 5_949_157_256_856_541_194],
        [11_083_321_508_415_952_377, 7_930_386_204_064_851_961],
        [6_533_480_499_674_460_970, 12_741_221_540_646_545_547],
        [15_919_246_764_230_384_755, 493_237_589_586_897_642],
        [12_383_349_438_457_732_815, 9_183_159_247_589_135_628],
        [11_198_100_388_422_760_695, 14_113_298_014_381_838_647],
    ],
    [
        [15_934_051_970_793_380_050, 15_386_918_489_199_617_820],
        [15_239_102_331_574_997_518, 5_509_566_918_550_206_628],
        [10_099_183_947_161_525_243, 9_203_019_853_854_518_954],
        [12_763_790_276_117_431_443, 8_601_208_915_559_612_456],
        [6_780_983_172_911_701_659, 7_553_101_063_643_132_431],
        [8_703_117_704_682_386_216, 11_376_243_546_202_152_900],
    ],
    [
        [6_272_939_414_622_188_789, 5_450_689_546_596_956_289],
        [17_897_802_172_562_405_692, 4_216_840_327_318_547_606],
        [7_663_291_433_122_506_876, 16_869_665_266_908_524_255],
        [2_765_922_899_972_110_667, 9_847_447_312_795_365_027],
        [14_031_058_935_278_551_791, 18_175_924_862_358_787_498],
        [17_453_796_359_929_960_392, 2_267_931_409_147_592_630],
    ],
    [
        [7_138_666_146_762_821_487, 6_834_682_368_918_972_135],
        [3_696_875_117_279_462_373, 3_967_384_405_088_497_079],
        [1_764_378_947_523_126_168, 4_811_536_208_277_120_330],
        [4_593_264_373_642_890_577, 9_929_253_848_944_581_970],
        [5_107_714_770_498_734_607, 11_316_391_444_875_009_165],
        [10_570_943_142_834_525_082, 6_395_675_079_283_270_295],
    ],
    [
        [7_225_631_690_543_289_168, 10_717_825_642_964_716_181],
        [10_859_736_714_381_746_091, 8_121_284_487_145_075_065],
        [5_820_422_365_263_660_124, 4_706_022_536_554_844_020],
        [3_158_223_615_069_289_642, 5_348_529_936_361_093_103],
        [1_122_164_482_183_171_018, 2_373_596_592_903_631_057],
        [9_736_635_378_249_847_453, 12_934_992_593_475_388_290],
    ],
    [
        [3_892_097_595_260_155_385, 4_707_783_840_868_912_275],
        [6_612_226_242_069_934_727, 1_468_416_874_522_005_730],
        [12_936_264_186_145_505_797, 2_607_373_434_122_262_912],
        [13_671_484_624_356_327_130, 13_128_708_559_417_648_125],
        [823_303_345_980_353_626, 15_195_905_110_619_493_303],
        [362_830_728_866_416_504, 2_655_464_836_299_302_939],
    ],
    [
        [7_828_325_570_785_338_895, 7_763_241_947_939_853_480],
        [3_194_615_233_424_363_806, 2_848_370_010_695_535_135],
        [9_408_348_941_084_041_014, 2_661_626_991_153_069_221],
        [15_124_769_082_058_958_687, 6_575_168_277_164_643_048],
        [1_381_103_538_182_975_800, 2_876_872_495_088_342_636],
        [1_325_553_428_788_532_522, 15_692_295_582_185_302_837],
    ],
    [
        [2_437_627_519_503_253_004, 6_656_559_208_061_837_159],
        [17_708_913_082_212_924_222, 5_433_266_215_990_364_495],
        [9_989_030_351_405_675_046, 7_485_098_168_273_597_441],
        [6_116_212_826_296_789_066, 4_635_535_061_986_947_838],
        [17_170_737_673_241_303_322, 3_128_235_923_424_980_692],
        [13_201_735_155_304_783_172, 7_095_541_244_940_188_401],
    ],
    [
        [8_196_661_389_046_893_469, 16_306_201_638_950_903_996],
        [4_725_629_266_975_527_894, 14_210_250_700_740_840_048],
        [2_849_863_034_653_146_257, 13_547_085_096_086_215_747],
        [4_664_417_134_088_968_947, 12_757_628_202_723_634_230],
        [5_346_100_451_906_631_490, 42_140_834_851_339_845],
        [10_415_380_456_202_401_148, 13_124_104_947_762_760_036],
    ],
    [
        [10_202_686_012_982_704_142, 6_949_208_221_954_208_997],
        [16_605_312_558_635_699_281, 2_010_439_375_914_914_245],
        [9_947_488_007_993_687_944, 8_557_877_704_156_465_544],
        [9_256_794_552_383_623_859, 1_383_642_063_300_078_741],
        [15_416_996_531_601_540_442, 2_011_929_294_337_368_934],
        [1_988_505_359_651_277_223, 2_805_404_791_919_444_030],
    ],
    [
        [13_988_429_249_875_837_714, 838_224_349_064_731_661],
        [11_740_331_219_085_023_026, 7_455_685_084_570_341_409],
        [5_268_546_906_058_063_390, 9_665_883_991_103_870_303],
        [4_153_572_744_311_269_266, 16_974_011_533_812_856_963],
        [3_252_524_679_990_046_982, 1_805_994_151_105_746_382],
        [2_717_050_386_921_169_670, 4_499_577_254_254_833_410],
    ],
    [
        [2_208_648_224_880_395_821, 5_792_766_379_481_664_243],
        [7_306_883_264_871_008_204, 17_728_685_252_851_219_143],
        [13_651_250_475_069_619_964, 14_498_976_773_896_711_326],
        [3_938_321_029_711_659_861, 7_203_614_769_312_454_425],
        [96_651_561_652_652_026, 17_912_310_574_082_615_195],
        [16_457_450_998_567_200_737, 13_087_226_315_628_128_030],
    ],
    [
        [7_992_581_223_028_794_087, 7_719_351_088_178_957_724],
        [18_278_346_302_268_003_320, 8_751_980_422_879_675_316],
        [4_060_605_037_368_072_287, 849_231_576_586_466_956],
        [3_221_549_073_520_347_138, 3_498_768_154_926_645_165],
        [4_036_145_003_302_584_637, 13_853_230_121_667_379_468],
        [16_662_386_502_029_266_921, 18_195_968_015_465_352_452],
    ],
    [
        [10_750_558_347_962_030_091, 15_907_474_856_781_998_219],
        [10_231_551_261_551_526_604, 3_273_052_469_594_833_618],
        [3_234_884_735_583_648_689, 85_937_689_850_116_791],
        [16_242_826_259_802_871_812, 2_379_457_834_277_099_277],
        [16_813_922_645_999_255_398, 13_968_013_032_604_645_270],
        [1_082_767_903_544_515_721, 2_251_081_503_002_701_850],
    ],
    [
        [9_834_287_269_475_554_643, 17_650_138_086_667_977_361],
        [15_024_395_448_744_795_088, 8_882_712_123_098_147_158],
        [10_784_898_861_257_160_825, 6_243_421_988_669_985_393],
        [1_718_143_270_825_484_936, 240_743_903_574_793_443],
        [7_598_999_826_146_039_713, 5_702_442_098_101_045_836],
        [17_996_297_225_689_436_850, 1_355_161_795_365_024_067],
    ],
    [
        [17_560_458_242_179_694_719, 8_322_888_833_468_142_548],
        [17_978_220_841_715_233_862, 13_646_734_040_700_887_274],
        [2_651_461_487_074_980_060, 15_302_955_340_064_392_876],
        [6_922_728_190_880_682_523, 4_584_449_031_715_800_647],
        [15_779_558_247_807_806_086, 7_979_513_383_582_368_113],
        [15_446_839_214_308_498_228, 12_980_862_144_805_318_793],
    ],
    [
        [4_154_938_442_608_612_342, 17_485_626_756_426_853_574],
        [8_517_161_989_045_981_631, 2_185_904_588_660_859_395],
        [12_877_471_233_627_355_215, 16_708_705_144_763_405_688],
        [16_518_311_926_072_498_880, 2_209_783_507_418_509_436],
        [5_041_330_832_522_948_677, 9_703_323_053_277_016_405],
        [485_461_215_193_441_123, 18_235_236_799_052_115_848],
    ],
    [
        [12_095_840_423_777_072_478, 18_184_851_099_831_008_588],
        [9_121_220_867_794_951_136, 3_362_248_466_797_802_259],
        [13_830_464_331_091_546_055, 7_887_328_503_881_137_541],
        [2_717_134_609_502_116_401, 3_151_262_443_840_568_004],
        [4_307_962_245_178_361_158, 2_009_875_218_980_675_013],
        [13_418_613_826_592_614_668, 12_122_022_570_206_019_005],
    ],
    [
        [3_466_480_152_039_938_200, 8_242_856_444_798_062_939],
        [9_267_801_001_438_090_435, 10_395_189_655_229_790_924],
        [7_750_966_685_779_908_642, 16_965_329_916_559_200_564],
        [994_725_560_061_531_054, 12_102_582_056_912_771_849],
        [13_215_949_942_942_206_503, 17_972_379_654_432_095_712],
        [1_789_982_290_846_440_510, 8_172_750_366_980_308_379],
    ],
    [
        [5_673_254_217_238_316_540, 900_992_740_804_221_313],
        [12_209_882_543_157_665_816, 15_098_865_361_431_627_652],
        [1_917_476_431_150_067_140, 14_039_115_240_650_919_338],
        [8_245_453_499_548_560_634, 14_871_774_617_356_619_943],
        [16_630_614_936_957_425_792, 1_577_206_248_623_259_209],
        [14_968_609_283_864_283_782, 8_094_127_085_592_259_981],
    ],
    [
        [17_518_038_171_145_229_764, 8_086_314_533_261_227_454],
        [18_104_481_720_601_799_881, 15_829_505_680_520_714_769],
        [6_027_228_290_869_608_748, 6_336_324_607_802_349_051],
        [10_356_429_860_658_504_735, 9_012_194_578_932_714_498],
        [11_715_026_065_550_788_032, 7_821_120_926_119_460_157],
        [3_310_752_755_662_606_342, 4_585_983_460_022_049_941],
    ],
    [
        [8_890_187_558_670_924_501, 14_066_173_152_019_126_861],
        [9_882_696_763_888_466_881, 6_243_843_032_320_860_218],
        [10_031_936_855_963_008_478, 14_856_031_637_580_709_544],
        [8_902_691_283_474_891_150, 18_182_545_333_852_257_005],
        [10_169_130_617_039_757_742, 5_715_725_163_630_400_628],
        [15_788_746_051_639_665_462, 6_513_264_013_417_541_906],
    ],
    [
        [3_357_401_854_089_605_336, 1_376_518_414_024_477_988],
        [8_451_313_861_535_704_190, 7_999_544_650_261_526_379],
        [14_570_752_385_596_303_000, 8_317_742_259_207_405_774],
        [13_134_168_096_352_956_684, 3_763_442_495_469_020_665],
        [4_118_160_248_925_381_498, 14_111_728_018_802_483_866],
        [15_082_780_492_858_946_742, 8_473_105_375_622_261_041],
    ],
    [
        [8_037_990_081_330_665_601, 7_505_317_489_120_458_065],
        [9_688_203_659_751_990_476, 14_519_939_734_062_546_734],
        [13_115_210_026_065_458_639, 13_470_918_205_317_450_871],
        [16_897_046_651_347_172_379, 15_630_042_108_408_122_864],
        [414_826_391_596_615_030, 14_779_176_993_058_006_840],
        [4_478_932_482_000_006_396, 695_455_345_245_712_315],
    ],
    [
        [6_884_952_710_633_107_382, 15_721_221_223_897_962_163],
        [3_613_599_199_827_547, 14_952_528_385_270_180_253],
        [5_364_527_230_714_204_621, 7_310_770_326_300_738_069],
        [9_246_037_983_701_160_127, 3_324_605_599_585_165_047],
        [12_728_118_561_602_933_520, 6_113_373_920_773_219_421],
        [15_371_653_297_656_955_559, 7_789_645_825_304_450_812],
    ],
    [
        [4_516_510_775_002_426_513, 3_566_584_478_581_873_212],
        [8_612_959_344_442_446_869, 15_360_738_315_019_883_086],
        [4_301_249_497_429_376_384, 16_418_099_929_799_381_752],
        [15_518_596_108_656_199_155, 14_633_418_594_576_613_692],
        [8_178_806_049_610_950_682, 3_256_339_422_672_622_302],
        [756_548_248_940_552_923, 17_317_528_353_089_304_043],
    ],
    [
        [15_454_817_700_272_548_110, 17_198_234_262_137_136_254],
        [2_558_361_820_929_487_520, 8_601_549_678_800_449_189],
        [12_279_306_716_889_220_222, 6_504_525_294_360_065_887],
        [4_191_690_648_182_441_120, 545_979_542_586_057_044],
        [2_924_813_836_407_529_485, 16_062_886_553_258_023_468],
        [14_294_514_175_163_210_354, 2_218_325_185_229_973_763],
    ],
    [
        [10_983_372_142_071_226_281, 10_673_533_601_225_795_291],
        [16_390_764_854_169_517_766, 14_318_866_971_343_881_430],
        [9_374_687_126_228_831_323, 3_888_617_263_348_830_277],
        [1_585_852_809_540_529_411, 3_645_998_864_687_605_515],
        [3_822_950_602_532_403_092, 2_945_042_110_248_410_024],
        [3_245_700_698_079_980_596, 6_863_201_950_048_280_129],
    ],
    [
        [14_804_379_758_688_002_122, 2_293_284_833_968_073_399],
        [11_882_020_160_970_452_760, 2_630_479_938_823_740_919],
        [17_146_932_215_141_377_384, 4_102_507_967_983_146_841],
        [15_791_179_214_244_650_165, 17_782_256_886_776_188_725],
        [8_818_869_438_925_288_308, 542_409_447_355_246_037],
        [5_130_643_318_760_237_204, 6_135_300_259_749_075_935],
    ],
    [
        [6_667_527_891_045_103, 6_051_811_410_088_945_928],
        [13_826_038_348_507_632_762, 9_333_025_458_754_159_937],
        [10_349_531_358_254_164_720, 13_818_102_641_201_195_341],
        [11_228_575_050_680_504_825, 14_171_604_677_665_562_948],
        [408_802_311_195_972_735, 13_110_537_548_489_213_391],
        [3_175_062_453_089_130_541, 4_035_664_867_916_633_890],
    ],
    [
        [6_676_544_636_053_560_174, 5_393_393_270_840_365_985],
        [8_538_520_863_276_656_999, 676_989_006_079_319_585],
        [14_516_408_521_828_760_150, 16_420_262_633_366_931_380],
        [1_299_683_309_589_890_348, 10_426_742_246_916_916_461],
        [14_459_310_219_049_212_575, 4_034_707_230_021_349_394],
        [7_853_242_450_810_480_526, 18_197_298_539_884_414_108],
    ],
    [
        [9_542_991_615_947_575_929, 292_061_666_645_761_691],
        [1_991_828_379_247_330_859, 15_959_081_902_805_162_035],
        [11_445_015_640_477_324_820, 5_568_719_595_272_022_292],
        [2_464_843_717_007_188_295, 10_802_309_296_363_304_108],
        [18_253_568_032_069_809_070, 18_355_530_924_964_178_033],
        [13_029_672_139_954_537_622, 13_859_789_774_884_353_662],
    ],
    [
        [15_847_630_075_660_619_709, 6_083_784_184_243_903_025],
        [7_729_982_226_222_894_712, 6_823_463_114_495_331_512],
        [14_186_611_509_182_015_525, 2_431_787_156_912_765_329],
        [16_953_679_319_920_802_798, 8_245_302_757_822_828_583],
        [13_944_170_238_824_674_708, 16_369_954_344_922_594_596],
        [7_905_833_579_457_642_655, 16_368_093_408_679_101_966],
    ],
    [
        [9_129_461_369_975_929_703, 13_766_441_918_594_711_256],
        [5_568_893_035_177_306_456, 4_605_528_160_275_031_226],
        [1_551_815_709_305_302_165, 4_553_365_954_250_863_656],
        [15_787_365_519_111_812_306, 3_389_064_139_401_109_858],
        [10_742_570_171_564_288_524, 9_448_120_286_568_228_713],
        [11_184_095_349_927_048_866, 13_410_493_938_165_595_350],
    ],
    [
        [8_942_808_504_924_989_119, 12_576_519_392_202_999_262],
        [7_894_648_412_541_494_164, 8_921_762_426_363_813_187],
        [16_648_000_779_790_610_434, 6_223_506_581_933_215_177],
        [13_884_390_006_094_644_263, 10_069_079_183_153_993_331],
        [135_383_389_425_047_939, 14_836_084_429_363_705_369],
        [11_989_518_386_415_735_843, 6_899_566_154_613_375_523],
    ],
    [
        [2_939_790_975_933_414_624, 12_147_524_706_367_442_806],
        [7_426_467_823_017_601_018, 9_375_879_036_623_728_719],
        [12_852_011_607_736_313_476, 8_357_340_672_838_956_964],
        [10_941_106_345_851_844_436, 17_850_259_290_882_241_732],
        [7_019_005_671_728_452_146, 16_797_691_642_402_486_471],
        [13_160_621_092_620_939_014, 10_432_660_606_826_335_532],
    ],
];
const CASTLE_KEYS: [u64; 4] = [
    13_903_699_408_998_609_807,
    1_394_504_070_964_353_662,
    2_001_174_967_191_055_984,
    13_016_778_750_842_461_853,
];
const EP_KEYS: [u64; 8] = [
    3_094_884_295_509_202_524,
    661_707_550_665_752_957,
    12_428_307_272_981_688_398,
    5_790_875_449_229_408_899,
    18_108_816_876_033_594_148,
    4_586_870_879_357_451_718,
    15_226_297_474_735_306_250,
    12_936_367_968_696_784_083,
];
pub const BLACK_TO_MOVE_KEY: u64 = 11_183_034_114_380_226_606;

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn no_equal_hashes() {
        // first, collect all the hash keys
        let mut hash_keys: Vec<u64> = Vec::new();
        hash_keys.extend(
            SQUARE_KEYS
                .iter()
                .flat_map(|x| x.iter())
                .flat_map(|x| x.iter()),
        );
        hash_keys.extend(CASTLE_KEYS);
        hash_keys.extend(EP_KEYS);
        hash_keys.push(BLACK_TO_MOVE_KEY);

        for (i, k0) in hash_keys.iter().enumerate() {
            for k1 in hash_keys[i + 1..].iter() {
                assert_ne!(k0, k1);
            }
        }
    }
}
